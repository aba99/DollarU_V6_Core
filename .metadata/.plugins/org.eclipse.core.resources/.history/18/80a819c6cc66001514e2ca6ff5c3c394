package com.orsyp.client.amex;


import java.util.ArrayList;
import java.util.HashMap;

import com.orsyp.tools.ps.Connector;
import com.orsyp.tools.ps.InMemoryFile;



public class AddDepConToUproc {

	static HashMap<String,ArrayList<String>> table = new HashMap<String,ArrayList<String>>();
	
	
	public static void main(String[] args) throws Exception {

		String fileName = args[0];
		String csvFile = args[1];
		
		InMemoryFile csvF = new InMemoryFile(csvFile);
		csvF.store();
		
		Connector conn = new Connector(fileName,false,"",false,"",false,"");
		
		
		
		for(String uprKey:csvF.getHash_Store().keySet())
		{
			{	
				if(!conn.getConnectionList().get(0).doesUprocExist(csvF.getHash_Store().get(uprKey).get(0)))
				{
							conn.getConnectionList().get(0).duplicateUproc("CABRIN_UPROC", csvF.getHash_Store().get(uprKey).get(0));
						
				}
				
				try{
				
					conn.getConnectionList().get(0).addDepToUprocAdhoc(uprKey,csvF.getHash_Store().get(uprKey));
			}
				catch(Exception e)
				{
					System.out.println(uprKey+" failed");
					continue;
				}
				}
			
			
		}
		
	}	
		

}

	

